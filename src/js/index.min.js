var Config=function(){function t(t){this.elem=t,this.ring=!1}return t.prototype.setData=function(t){t?(this.width=t.width||"100%",this.height=t.height||"100%",this.img=this.setImg(t.img)||this.setImg("default")):(this.width=this.height="100%",this.img=this.setImg("default"))},t.prototype.setImg=function(t){switch(t){case"circle_white":return"../assets/img/rgb_circle_white_1000_1000.png";case"ring_full":return this.ring=!0,"../assets/img/rgb_ring_full_1000_1000.png";case"ring_transparent":return this.ring=!0,"../assets/img/rgb_ring_transparent_1000_1000.png";case"circle_full":default:return"../assets/img/rgb_circle_full_1000_1000.png"}},t}(),CoreColorPicker=function(){function t(t,s){this.config=new Config(t),this.config.setData(s),this.init(),this._resize()}return t.prototype.init=function(){var t=this;this._createParent(this.config.elem),this._createCursor(),this._setCursor(this.canvas.width/2-(this.canvas.width<300?6:10),this.canvas.height/2-(this.canvas.width<300?6:10)),this.context=this.canvas.getContext("2d"),this.image=new Image,this.image.onload=function(){t.context.drawImage(t.image,0,0,t.canvas.width,t.canvas.height)},this.image.src=this.config.img,this.canvas.onclick=function(s){t._func(s).then(function(){t._start("colorClick")},function(){})},this.canvas.onmousedown=function(){t.canvas.onmousemove=function(s){t._func(s).then(function(){t._start("colorMove")},function(){})},document.onmouseup=function(){document.onmouseup=t.canvas.onmousemove=null}},this.cursor.onmousedown=function(){t.canvas.onmousemove=function(s){t._func(s).then(function(){t._start("colorMove")},function(){})},document.onmouseup=function(){document.onmouseup=t.canvas.onmousemove=null}}},t.prototype.colorClick=function(t){this.canvas.addEventListener("colorClick",t,!1)},t.prototype.colorMove=function(t){this.canvas.addEventListener("colorMove",t,!1)},t.prototype._createParent=function(t){var s=this,n=t;this.parentCanvas?n.removeChild(this.parentCanvas):null,this.parentCanvas=document.createElement("div"),this.parentCanvas.style.width=this.config.width,this.parentCanvas.style.height=this.config.height,n.appendChild(this.parentCanvas),this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=this.parentCanvas.offsetWidth,this.canvas.onmousemove=function(t){var n=s.canvas.width/2;Math.pow(n-t.offsetX,2)+Math.pow(n-t.offsetY,2)<Math.pow(n,2)?s.canvas.style.cursor="move":s.canvas.style.cursor="default"},this.parentCanvas.appendChild(this.canvas)},t.prototype._createCursor=function(){var t=this;this.cursor=document.createElement("div"),this.cursor.style.position="absolute",this.cursor.onmouseover=function(){t.cursor.style.cursor="pointer"},this.cursor.style.width=(this.canvas.width<300?8:14)+"px",this.cursor.style.height=(this.canvas.width<300?8:14)+"px",this.cursor.style.backgroundColor="transparent",this.cursor.style.borderRadius="50%",this.cursor.style.border=(this.canvas.width<300?2:4)+"px solid white",this.parentCanvas.insertBefore(this.cursor,this.canvas)},t.prototype._func=function(t){var s=this,n=this.canvas.width/2;return new Promise(function(i,o){if(Math.pow(n-t.offsetX,2)+Math.pow(n-t.offsetY,2)>=Math.pow(n,2))o(!0);else{var e=s.config.ring?s._ring(t):[t.offsetX,t.offsetY],a=s.context.getImageData(e[0],e[1],1,1).data;s.colorRgb=[a[0],a[1],a[2]],s.colorHex="#"+s.toHex(a[0],a[1],a[2]),s._setCursor(e[0]-(s.canvas.width<300?6:10),e[1]-(s.canvas.width<300?6:10)),i(!0)}})},t.prototype._ring=function(t){var s=this.canvas.width/2,n=[this.canvas.width-this.canvas.width/2,0],i=[t.offsetX-this.canvas.width/2,t.offsetY-this.canvas.height/2],o=(n[0]*i[0]+n[1]*i[1])/(Math.sqrt(Math.pow(n[0],2)+Math.pow(n[1],2))*Math.sqrt(Math.pow(i[0],2)+Math.pow(i[1],2))),e=.88*s*o+s,a=Math.sqrt(Math.pow(.88*s,2)-Math.pow(e-this.canvas.width/2,2))*(t.offsetY>this.canvas.height/2?1:-1)+this.canvas.height/2;return[e,a]},t.prototype._setCursor=function(t,s){this.cursorX=t,this.cursorY=s,this.cursor.style.marginTop=s+"px",this.cursor.style.marginLeft=t+"px"},t.prototype._start=function(t){var s=new CustomEvent(t,{detail:{colorRbg:this.colorRgb,colorHex:this.colorHex}});this.canvas.dispatchEvent(s)},t.prototype._resize=function(){var t=this;this.config.width.indexOf("%")!=-1&&(window.onresize=function(){t.init()})},t.prototype.toHex=function(t,s,n){var i=t.toString(16),o=s.toString(16),e=n.toString(16);return 1==i.length&&(i="0"+i),1==o.length&&(o="0"+o),1==e.length&&(e="0"+e),(i+o+e).toUpperCase()},t}();